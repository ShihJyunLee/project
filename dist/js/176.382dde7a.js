"use strict";(self["webpackChunkfirst_project"]=self["webpackChunkfirst_project"]||[]).push([[176],{176:function(t,a,e){e.r(a),e.d(a,{default:function(){return gt}});var s=e(3396),d=e(7139),i=e(9242);const o=t=>((0,s.dD)("data-v-d65e68ba"),t=t(),(0,s.Cn)(),t),l={class:"container mt-5"},c=o((()=>(0,s._)("div",{class:"mt-5"},null,-1))),n={"aria-label":"breadcrumb",class:"mb-3"},r={class:"breadcrumb"},u={class:"breadcrumb-item"},p={class:"breadcrumb-item"},b=o((()=>(0,s._)("li",{class:"breadcrumb-item"},"購物車",-1))),m=(0,s.uE)('<div class="mt-5" data-v-d65e68ba><h2 class="text-center mb-4" data-v-d65e68ba>結帳流程</h2><div class="text-center text-nowrap" data-v-d65e68ba><div class="d-inline-block" data-v-d65e68ba><div class="border rounded rounded-4 p-2 me-3 position-relative bg-secondary text-white" data-v-d65e68ba>確認品項 <div class="line" data-v-d65e68ba></div></div></div><div class="d-inline-block" data-v-d65e68ba><div class="border rounded rounded-4 p-2 me-3 position-relative" data-v-d65e68ba>填寫資料 <div class="line" data-v-d65e68ba></div></div></div><div class="d-inline-block" data-v-d65e68ba><div class="border rounded rounded-4 p-2 me-3 position-relative" data-v-d65e68ba>前往付款 <div class="line" data-v-d65e68ba></div></div></div><div class="d-inline-block" data-v-d65e68ba><div class="border rounded rounded-4 p-2 position-relative" data-v-d65e68ba>結帳成功</div></div></div></div>',1),v={class:"row mt-5"},_={class:"col-md-6"},h=o((()=>(0,s._)("h2",{class:"text-center border p-3 mb-4 custom-bg"},"購物車列表",-1))),g={class:"row g-0"},y={class:"col-md-4"},w=["src"],x={class:"col-md-8 g-1"},k={class:"card-body"},C={class:"card-title"},f={class:"mt-2 text-secondary"},$={key:0,class:"card-text text-danger mt-5"},D={key:1,class:"card-text mt-5"},z={class:"row"},L={class:"col-md-6 col-8"},I={class:"input-group input-group-sm"},q=["onClick"],M=["onUpdate:modelValue","onChange","disabled"],U=["onClick"],N={class:"input-group-text"},T={class:"col-md-6 col-4"},H={key:0,class:"card-text text-end text-success"},Q={key:1,class:"card-text text-end"},S=["disabled","onClick"],V=o((()=>(0,s._)("i",{class:"bi bi-x"},null,-1))),W=[V],Y={class:"needs-validation"},j={class:"row mb-4"},A={class:"col-md-6"},K={class:"input-group input-group-sm"},E={class:"input-group-append"},P=o((()=>(0,s._)("div",{class:"col-md-6 mt-2 mt-md-0 text-end mt-3"},[(0,s._)("button",{type:"button",class:"btn btn-outline-danger btn-block rounded-1","data-bs-toggle":"modal","data-bs-target":"#exampleModal"},"清除所有購物車")],-1))),Z={class:"col-md-6 d-flex flex-column mb-3"},B={class:"border border-black"},F=o((()=>(0,s._)("h2",{class:"text-center p-3 border-bottom"},"訂單明細",-1))),G={class:"row mt-5 ms-2"},J=o((()=>(0,s._)("div",{class:"col-md-6 h5"},[(0,s._)("strong",null,"小計:")],-1))),O={class:"col-md-6 text-end pe-5"},R={key:0,class:"ps-4 text-success"},X={key:1,class:"ps-4 text-secondary"},tt={class:"ps-4"},at={class:"row mt-5 ms-2 mb-3 border-top p-3"},et=o((()=>(0,s._)("div",{class:"col-md-6 h4"},[(0,s._)("strong",null,"總計:")],-1))),st={class:"col-md-6 text-end pe-5"},dt=["id"],it={key:1,class:"text-success"},ot=["id"],lt=["disabled"],ct={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},nt={class:"modal-dialog modal-dialog-centered"},rt={class:"modal-content"},ut=o((()=>(0,s._)("div",{class:"modal-header"},[(0,s._)("h5",{class:"modal-title text-danger",id:"exampleModalLabel"},"確認刪除所有購物車品項"),(0,s._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1))),pt={class:"modal-footer"},bt=o((()=>(0,s._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"關閉",-1)));function mt(t,a,e,o,V,mt){const vt=(0,s.up)("Loading"),_t=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(vt,{active:V.isLoading},null,8,["active"]),(0,s._)("div",l,[c,(0,s._)("nav",n,[(0,s._)("ol",r,[(0,s._)("li",u,[(0,s.Wm)(_t,{to:"/"},{default:(0,s.w5)((()=>[(0,s.Uk)("首頁")])),_:1})]),(0,s._)("li",p,[(0,s.Wm)(_t,{to:"/user/cart"},{default:(0,s.w5)((()=>[(0,s.Uk)("商品列表")])),_:1})]),b])]),m,(0,s._)("div",v,[(0,s._)("div",_,[h,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(V.cart.carts,(a=>((0,s.wg)(),(0,s.iD)("div",{key:a.id,class:"card mb-3"},[(0,s._)("div",g,[(0,s._)("div",y,[(0,s._)("img",{src:a.product.imageUrl,class:"img-fluid rounded-start",alt:"Product Image"},null,8,w)]),(0,s._)("div",x,[(0,s._)("div",k,[(0,s._)("h5",C,(0,d.zw)(a.product.title),1),(0,s._)("p",f,[(0,s._)("small",null,"產地: "+(0,d.zw)(a.product.category),1)]),a.product.origin_price?((0,s.wg)(),(0,s.iD)("p",$,"特價: NT$"+(0,d.zw)(t.$filters.currency(a.product.price)),1)):((0,s.wg)(),(0,s.iD)("p",D,"原價: NT$"+(0,d.zw)(t.$filters.currency(a.product.origin_price)),1)),(0,s._)("div",z,[(0,s._)("div",L,[(0,s._)("div",I,[(0,s._)("button",{class:"btn btn-outline-secondary",type:"button",onClick:t=>mt.updateQuantity(a,"decrement")},"-",8,q),(0,s.wy)((0,s._)("input",{type:"tel",class:"form-control","onUpdate:modelValue":t=>a.qty=t,min:"1",onChange:t=>mt.updateCart(a),disabled:a.id===V.status.loadingItem},null,40,M),[[i.nr,a.qty,void 0,{number:!0}]]),(0,s._)("button",{class:"btn btn-outline-secondary",type:"button",onClick:t=>mt.updateQuantity(a,"increment")},"+",8,U),(0,s._)("div",N,"/ "+(0,d.zw)(a.product.unit),1)])]),(0,s._)("div",T,[V.coupon_state?((0,s.wg)(),(0,s.iD)("p",H,"折扣價 NT$"+(0,d.zw)(t.$filters.currency(a.final_total)),1)):((0,s.wg)(),(0,s.iD)("p",Q,"NT$"+(0,d.zw)(t.$filters.currency(a.total)),1))])]),(0,s._)("button",{type:"button",class:"btn btn-outline-danger position-absolute top-0 end-0 border-0",disabled:V.status.loadingItem===a.id,onClick:t=>mt.removeCartItem(a.id)},W,8,S)])])])])))),128)),(0,s._)("div",Y,[(0,s._)("div",j,[(0,s._)("div",A,[(0,s._)("div",K,[(0,s.wy)((0,s._)("input",{type:"text",class:"form-control","onUpdate:modelValue":a[0]||(a[0]=t=>V.coupon_code=t),placeholder:"請輸入優惠碼"},null,512),[[i.nr,V.coupon_code]]),(0,s._)("div",E,[(0,s._)("button",{class:"btn btn-outline-secondary bg-success text-white",type:"submit",onClick:a[1]||(a[1]=(...t)=>mt.addCouponCode&&mt.addCouponCode(...t))},"套用優惠碼")])])]),P])])]),(0,s._)("div",Z,[(0,s._)("div",B,[F,(0,s._)("div",G,[J,(0,s._)("div",O,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(V.cart.carts,(t=>((0,s.wg)(),(0,s.iD)("div",{key:t.id,class:"border-bottom mb-4"},[(0,s.Uk)((0,d.zw)(t.product.title)+" ",1),V.coupon_state?((0,s.wg)(),(0,s.iD)("span",R,[(0,s._)("small",null,"NT$"+(0,d.zw)(t.final_total),1)])):((0,s.wg)(),(0,s.iD)("span",X,[(0,s._)("small",null,"NT$"+(0,d.zw)(t.total),1)])),(0,s._)("span",tt,"x"+(0,d.zw)(t.qty),1)])))),128))])]),(0,s._)("div",at,[et,(0,s._)("div",st,[V.coupon_state?((0,s.wg)(),(0,s.iD)("div",{key:0,class:"h4 text-success",id:V.total},(0,d.zw)(V.final_total),9,dt)):(0,s.kq)("",!0),V.coupon_state?((0,s.wg)(),(0,s.iD)("div",it,"已使用優惠卷")):((0,s.wg)(),(0,s.iD)("div",{key:2,class:"h4",id:V.total},(0,d.zw)(V.total),9,ot))])]),(0,s._)("button",{class:"btn btn-block text-white bg-dark text-center w-100 p-2 rounded-0",type:"button",onClick:a[2]||(a[2]=t=>mt.material()),disabled:0===this.total},"前往結帳",8,lt)])])])]),(0,s._)("div",ct,[(0,s._)("div",nt,[(0,s._)("div",rt,[ut,(0,s._)("div",pt,[(0,s._)("button",{type:"button",class:"btn btn-danger","data-bs-dismiss":"modal",onClick:a[3]||(a[3]=t=>mt.removeAllCart())},"確定"),bt])])])])],64)}e(560);var vt={data(){return{isLoading:!1,status:{loadingItem:""},cart:{},coupon_code:"",coupon_state:"",total:"",final_total:""}},methods:{getCart(){const t="https://vue3-course-api.hexschool.io/api/rou-api/cart";this.isLoading=!0,this.$http.get(t).then((t=>{this.cart=t.data.data,this.isLoading=!1,this.final_total=t.data.data.final_total,this.total=t.data.data.total,console.log(this.cart)}))},updateQuantity(t,a){"increment"===a?t.qty+=1:"decrement"===a&&t.qty>1&&(t.qty-=1),this.updateCart(t)},updateCart(t){const a=`https://vue3-course-api.hexschool.io/api/rou-api/cart/${t.id}`;this.isLoading=!0,this.status.loadingItem=t.id;const e={product_id:t.product_id,qty:t.qty};this.$http.put(a,{data:e}).then((t=>{this.status.loadingItem="",this.getCart()}))},addCouponCode(){const t="https://vue3-course-api.hexschool.io/api/rou-api/coupon",a={code:this.coupon_code};this.$http.post(t,{data:a}).then((t=>{this.coupon_state=t.data.success,this.coupon_state,this.$httpMessageState(t,"套用優惠卷"),this.getCart()}))},removeCartItem(t){this.status.loadingItem=t;const a=`https://vue3-course-api.hexschool.io/api/rou-api/cart/${t}`;this.isLoading=!0,this.$http.delete(a).then((t=>{this.$httpMessageState(t,"移除購物車品項"),this.status.loadingItem="",this.getCart(),this.isLoading=!1}))},removeAllCart(){const t="https://vue3-course-api.hexschool.io/api/rou-api/carts";this.isLoading=!0,this.$http.delete(t).then((t=>{this.isLoading=!1,this.$httpMessageState(t,"移除購物車品項"),this.getCart()}))},material(){this.$router.push("material")}},created(){this.getCart()}},_t=e(89);const ht=(0,_t.Z)(vt,[["render",mt],["__scopeId","data-v-d65e68ba"]]);var gt=ht}}]);
//# sourceMappingURL=176.382dde7a.js.map